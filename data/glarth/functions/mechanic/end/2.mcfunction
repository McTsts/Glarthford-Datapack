#scoreboard players set 2 Const 2
execute if score timer end matches 1 run scoreboard players set @a MusicSet 101
execute if score timer end matches 1 run kill @e[tag=end_scene]
execute if score timer end matches 1 run summon minecraft:armor_stand -1 37 -185 {DisabledSlots:4144959,Rotation:[0f,0f],Passengers:[{DisabledSlots:4144959,Invisible:1,NoGravity:1,Silent:1b,Marker:1,id:"armor_stand",ArmorItems:[{},{},{},{id:"diamond_hoe",Count:1,tag:{CustomModelData:1}}],Tags:["charQ","charQ1","end_scene"],Rotation:[0f,0f]},{DisabledSlots:4144959,Invisible:1,NoGravity:1,Silent:1b,Marker:1,id:"armor_stand",Tags:["charQ","charQ2","end_scene"],Rotation:[0f,0f]},{DisabledSlots:4144959,Invisible:1,NoGravity:1,Silent:1b,Marker:1,id:"armor_stand",Tags:["charQ","charQ3","end_scene"],Rotation:[0f,0f]},{DisabledSlots:4144959,Invisible:1,NoGravity:1,Silent:1b,Marker:1,id:"armor_stand",Tags:["charQ","charQ4","end_scene"],Rotation:[0f,0f],Pose:{RightArm:[0.0f,0.0f,0.0f]}}],Tags:["charQB","end_scene"],CustomNameVisible:1}
execute if score timer end matches 1 run tag @r[scores={playerid=1..3},gamemode=adventure] add endTemp
execute if score timer end matches 1 unless entity @a[tag=endTemp] run tag @r[gamemode=adventure] add endTemp
execute if score timer end matches 1 as @a[tag=endTemp] run loot replace entity @e[type=armor_stand,tag=charQ4,tag=end_scene] armor.head loot glarth:custom/skull
execute if score timer end matches 1 as @e[tag=charQ4,tag=end_scene,type=armor_stand] run data modify entity @s HandItems[0] merge from entity @s ArmorItems[3]
execute if score timer end matches 1 as @e[tag=charQ4,tag=end_scene,type=armor_stand] run data remove entity @s ArmorItems[3]
execute if score timer end matches 1 at @e[tag=charQB,tag=end_scene] as @a[tag=endTemp] run function glarth:mechanic/make_char
execute if score timer end matches 1 run data merge block 84 26 -123 {Text1:'""'}
execute if score timer end matches 1 run data merge block 84 26 -123 {Text1:'{"entity":"@p[tag=endTemp]","nbt":"EnderItems[{Slot:0b}].tag.name","interpret":true}'}
execute if score timer end matches 1 run data modify entity @e[type=armor_stand,limit=1,tag=charQB,tag=end_scene] CustomName set from block 84 26 -123 Text1
execute if score timer end matches 1 run tag @a remove endTemp

#Spawn
execute if score timer end matches 1 run summon armor_stand 12 34 -211 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:9,Unbreakable:1}}],Tags:["end_scene"],Rotation:[7f,0f],CustomName:"{\"translate\":\"baker\",\"color\":\"#FF8488\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand -1 36.5 -212 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:10,Unbreakable:1}}],Tags:["end_scene"],Rotation:[-15f,0f],CustomName:"{\"translate\":\"butcher\",\"color\":\"dark_red\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand 23 45.5 -185 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:16,Unbreakable:1}}],Tags:["end_scene"],Rotation:[30f,0f],CustomName:"{\"translate\":\"guard\",\"color\":\"gray\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand -14 37 -185 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:5,Unbreakable:1}}],Tags:["end_scene"],Rotation:[-40f,0f],CustomName:"{\"translate\":\"priest\",\"color\":\"white\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand 29 34 -150 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:8,Unbreakable:1}}],Tags:["end_scene"],Rotation:[80f,0f],CustomName:"{\"translate\":\"fisher\",\"color\":\"#00A975\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand 29 34.5 -170 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:7,Unbreakable:1}}],Tags:["end_scene"],Rotation:[45f,0f],CustomName:"{\"translate\":\"richard\",\"color\":\"dark_aqua\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 if score mayorHatless Stats matches 0 run summon armor_stand 20 34.5 -170 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:23,Unbreakable:1}}],Tags:["end_scene"],Rotation:[35f,0f],CustomName:"{\"translate\":\"mayor\",\"color\":\"#282828\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 if score mayorHatless Stats matches 1 run summon armor_stand 20 34.5 -170 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{CustomModelData:37,Unbreakable:1}}],Tags:["end_scene"],Rotation:[35f,0f],CustomName:"{\"translate\":\"mayor\",\"color\":\"#282828\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand 23 34.5 -170 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:6,Unbreakable:1}}],Tags:["end_scene"],Rotation:[35f,0f],CustomName:"{\"translate\":\"blacksmith\",\"color\":\"#282828\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand 11 36 -191 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:12,Unbreakable:1}}],Tags:["end_scene"],Rotation:[5f,0f],CustomName:"{\"translate\":\"worker\",\"color\":\"#8C5800\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand -6 34.5 -170 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:4,Unbreakable:1}}],Tags:["end_scene"],Rotation:[-50f,0f],CustomName:"{\"translate\":\"bum\",\"color\":\"#8C5800\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand -6 40 -165 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:35,Unbreakable:1}}],Tags:["end_scene"],Rotation:[-25f,0f],CustomName:"{\"translate\":\"merchant2\",\"color\":\"dark_blue\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 if score marhjoSaved Stats matches 1 run summon armor_stand 14 36 -193 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:55,Unbreakable:1}}],Tags:["end_scene"],Rotation:[5f,0f],CustomName:"{\"translate\":\"marhjo\",\"color\":\"dark_green\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand -5 39 -158 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:50,Unbreakable:1}}],Tags:["end_scene"],Rotation:[-10f,0f],CustomName:"{\"translate\":\"mourner\",\"color\":\"gray\"}",CustomNameVisible:1,NoGravity:1}
execute if score timer end matches 1 run summon armor_stand -12 42 -156 {Invulnerable:1b,Invisible:1b,DisabledSlots:2036499,ArmorItems:[{},{},{},{id:"minecraft:diamond_hoe",Count:1b,tag:{Damage:66,Unbreakable:1}}],Tags:["end_scene"],Rotation:[-30f,0f],CustomName:"{\"translate\":\"hermit\",\"color\":\"yellow\"}",CustomNameVisible:1,NoGravity:1}
#Scene
execute if score timer end matches 1 run gamemode spectator @a[gamemode=adventure]
execute if score timer end matches 1 run summon area_effect_cloud 7 39 -200 {Rotation:[0f,0f],Radius:0.0f,Duration:2147483647,Tags:["cutscenePov"]}
execute if score timer end matches 1..150 as @a[gamemode=spectator] run spectate @e[type=area_effect_cloud,tag=cutscenePov,x=7,y=39,z=-200,distance=..1,limit=1] @s
execute if score timer end matches 1..150 run effect clear @a[gamemode=spectator] minecraft:night_vision
execute if score timer end matches 80 run function glarth:dialogue/citizen/lines/end_2
scoreboard players operation mod end = timer end
scoreboard players operation mod end %= 2 Const
execute if score mod end matches 0 at @r run function glarth:mechanic/action/firework
execute if score timer end matches 200 run function glarth:mechanic/win